<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCC Analyser</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins">
    <link rel="stylesheet" href="styles/css-reset.css">

    <link rel="stylesheet" href="styles/style.css">

    <link rel="stylesheet" href="styles/container.css">

    <link rel="stylesheet" href="styles/player-list.css">
    <link rel="stylesheet" href="styles/game-player-coins.css">
    <link rel="stylesheet" href="styles/total-player-coins.css">

    <link rel="stylesheet" href="styles/total-team-coins.css">
    <link rel="stylesheet" href="styles/team-avg.css">




    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
    <div class="teams"></div>
    <div class="container" x-data="{ playerdata: null, players: [], game: null }">
        <div class="container-header">
            <span>Red Rabbits</span>
            <select class="game-selector" x-model="game" x-ref="gameSelected">
                <option value="MG_ROCKET_SPLEEF">Rocket Spleef Rush</option>
                <option value="MG_BATTLE_BOX">Battle Box</option>
                <option value="MG_MELTDOWN">Meltdown</option>
                <option value="MG_SANDS_OF_TIME">Sands of Time</option>
                <option value="MG_BUILD_MART">Buildmart</option>
                <option value="MG_GRID_RUNNERS">Grid Runners</option>
                <option value="MG_SKYBATTLE">Sky Battle</option>
                <option value="MG_ACE_RACE">Ace Race</option>
                <option value="MG_HOLE_IN_THE_WALL">Role in the Wall</option>
            </select>
        </div>
        <div class="player-list" x-data="{
            async getPlayerNames() {
                let players = []
                let playerdata = await fetch('db/participants-red.json').then(response => response.json()).then(response => response.data)
                for (p in playerdata) { 
                    players.push(playerdata[p].username)
                }
                this.players = players
            }
        }" x-init="getPlayerNames()">
            <h2>Players</h2>
            <template x-for="username in players">
                <p x-text="username"></p>
            </template>
        </div> <!-- Done!!! -->


        <div class="cell game-player-coins" x-data="{ gamePlayerCoins: [], 
            async getgamePlayerCoins() {
                let gamePlayerCoins = []
                let res = await fetch('db/' + $refs.gameSelected._x_model.get()).then(response => response.json()).then(response => response.data)
                console.log(res)
                this.gamePlayerCoins = gamePlayerCoins
            }
        
        }" x-init="getgamePlayerCoins">
            <h2>Game Coins</h2>
            <!-- <template x-for="coinRank in coinRanks">
                <p x-text="coinRank"></p>
            </template> -->
        </div>

        <div class="cell total-player-coins" x-data="{
            totalPlayerCoins: [],
            async gettotalPlayerCoins() {
                let totalPlayerCoins = []
                let res = await fetch('db/individualScores.json').then(response => response.json()).then(response => response.data)
                for (p in this.players) {
                    totalPlayerCoins.push(res.individualScores[this.players[p]])
                }
                this.totalPlayerCoins = totalPlayerCoins
            }
        }" x-init="gettotalPlayerCoins()">
            <h2>Total Player Coins</h2>
            <template x-for="totalPlayerCoin in totalPlayerCoins">
                <p x-text="totalPlayerCoin"></p>
            </template>
        </div>  <!-- Done!!! -->

        <div class="cell total-team-coins" x-data="{ totalTeamCoins: [1456 + 1267 + 2430 + 1524] }">
            <h2>Total Team Coins</h2>
            <p x-text="totalTeamCoins"></p>
        </div>

        <div class="cell team-avg" x-data="{ teamAvg: [(1456 + 1267 + 2430 + 1524) / 4] }">
            <h2>Total Team Coins</h2>
            <p x-text="teamAvg"></p>
        </div>
    </div>

</body>
</html>